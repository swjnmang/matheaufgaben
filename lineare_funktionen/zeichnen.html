<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aufgabengenerator: Lineare Funktionen zeichnen</title>
    <style>
        /* Modernes & ansprechendes Design */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        #task-generator-container {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 25px 30px;
            width: 100%;
            max-width: 600px;
            margin: 20px;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        #task-generator-container h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        /* Schwierigkeitsstufen */
        #difficulty-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .difficulty-button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #f8f9fa;
            color: #495057;
            transition: all 0.3s ease;
        }
        .difficulty-button.active {
            background-color: #0073aa;
            color: white;
            border-color: #0073aa;
            font-weight: bold;
        }
        #task-output {
            background-color: #f8f9fa;
            border: 1px solid #dcdcdc;
            border-radius: 8px;
            padding: 30px 20px;
            margin-bottom: 20px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            color: #495057;
        }
        #task-equation {
            font-size: 1.8em;
            font-weight: bold;
            color: #005a87;
            font-family: 'Courier New', Courier, monospace;
            margin-top: 10px;
        }
        #drawing-range-hint {
            margin-top: 15px;
            color: #6c757d;
            font-size: 0.9em;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .generator-button {
            background: linear-gradient(145deg, #0078b3, #005f8e);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .generator-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        .geogebra-button {
             background: linear-gradient(145deg, #4a90e2, #2c6eb5);
        }
    </style>
</head>
<body>

<div id="task-generator-container">
    <h2>Lineare Funktionen zeichnen</h2>
    
    <div id="difficulty-selector">
        <button class="difficulty-button" id="diff-easy" onclick="setDifficulty('easy')">Leicht</button>
        <button class="difficulty-button" id="diff-medium" onclick="setDifficulty('medium')">Mittel</button>
        <button class="difficulty-button" id="diff-hard" onclick="setDifficulty('hard')">Schwer</button>
    </div>

    <div id="task-output">
        <span id="task-text">Zeichne den Graphen der folgenden Funktion in ein Koordinatensystem.</span>
        <span id="task-equation">y = 2x + 1</span>
        <div id="drawing-range-hint"></div>
    </div>

    <div class="button-container">
        <button class="generator-button" onclick="generateNewTask()">Neue Aufgabe</button>
        <button class="generator-button geogebra-button" onclick="openGeoGebra()">Lösungskontrolle anzeigen</button>
    </div>
</div>

<script>
    let currentDifficulty = 'easy';
    let currentGeoGebraURL = '';

    function setDifficulty(level) {
        currentDifficulty = level;
        // Update active button style
        document.querySelectorAll('.difficulty-button').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(`diff-${level}`).classList.add('active');
        generateNewTask();
    }

    // Hilfsfunktion zur Darstellung von Brüchen
    function toFraction(decimal) {
        if (decimal === 0) return "0";
        if (Math.abs(decimal) === 0.5) return (decimal > 0 ? "" : "-") + "1/2";
        if (Math.abs(decimal) === 0.25) return (decimal > 0 ? "" : "-") + "1/4";
        if (Math.abs(decimal) === 0.75) return (decimal > 0 ? "" : "-") + "3/4";
        if (Math.abs(decimal) === 1/3) return (decimal > 0 ? "" : "-") + "1/3";
        if (Math.abs(decimal) === 2/3) return (decimal > 0 ? "" : "-") + "2/3";
        return decimal;
    }

    // Hilfsfunktion zum Formatieren von Zahlen mit max. 2 Nachkommastellen
    function formatNumber(num) {
        // Runde auf 2 Dezimalstellen, um lange Brüche zu vermeiden
        const roundedNum = Math.round(num * 100) / 100;
        const fraction = toFraction(roundedNum);
        // Wenn toFraction einen bekannten Bruch zurückgibt, verwende diesen
        if (fraction !== roundedNum) {
            return fraction;
        }
        // Ansonsten gib die gerundete Zahl zurück
        return roundedNum;
    }

    function generateNewTask() {
        let m, t;
        let m_str, t_str;

        const randomInt = (max, min = 0) => Math.floor(Math.random() * (max - min + 1)) + min;
        const randomChoice = (arr) => arr[Math.floor(Math.random() * arr.length)];
        
        // Generate m and t based on difficulty, with m between -3 and 3
        switch (currentDifficulty) {
            case 'medium':
                m = randomChoice([
                    randomInt(2, -2), // whole numbers
                    0.5, -0.5, 1.5, -1.5, 2.5, -2.5
                ]);
                if (m === 0) m = 1.5; // Avoid m=0
                t = randomChoice([randomInt(5, -5), randomInt(9, -9) / 2]); // .5 decimals for t
                break;
            case 'hard':
                const numerators = [-9, -8, -7, -6, -5, -4, -3, -2, -1, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                const denominators = [3, 4, 5];
                m = randomChoice(numerators) / randomChoice(denominators);
                // Ensure m is within [-3, 3] and not 0
                m = Math.max(-3, Math.min(3, m));
                if (Math.abs(m) < 0.1) m = 2/3;
                
                t = randomChoice(numerators.slice(4,-4)) / randomChoice(denominators);
                t = Math.round(t * 4) / 4; // Round to .25 for nicer values
                break;
            case 'easy':
            default:
                m = randomInt(3, -3);
                if (m === 0) m = 1; // Avoid m=0
                t = randomInt(8, -8);
                break;
        }

        // Format m for display
        if (m === 1) m_str = "x";
        else if (m === -1) m_str = "-x";
        else if (currentDifficulty === 'hard') m_str = `(${formatNumber(m)})x`;
        else m_str = `${formatNumber(m)}x`;

        // Format t for display
        if (t === 0) t_str = "";
        else if (t > 0) t_str = ` + ${formatNumber(t)}`;
        else t_str = ` - ${formatNumber(Math.abs(t))}`;

        const equation = `y = ${m_str}${t_str}`;
        document.getElementById('task-equation').textContent = equation;
        
        document.getElementById('task-text').innerHTML = "Zeichne den Graphen der folgenden Funktion in ein Koordinatensystem. Als Hilfestellung kannst du eine Wertetabelle erstellen.";
        const rangeHint = `Ein guter Zeichenbereich für die x-Achse ist von -5 bis +5, die Länge der y-Achse musst du selbst festlegen, häufig reicht hier ebenfalls -5 bis +5.`;
        document.getElementById('drawing-range-hint').innerHTML = rangeHint;

        // Prepare GeoGebra URL
        const geogebra_equation = `y = ${m}*x + ${t}`;
        currentGeoGebraURL = `https://www.geogebra.org/graphing?command=${encodeURIComponent(geogebra_equation)}`;
    }

    function openGeoGebra() {
        if (currentGeoGebraURL) {
            window.open(currentGeoGebraURL, '_blank');
        }
    }

    // Initial load
    window.onload = function() {
        setDifficulty('easy');
    };

</script>

</body>
</html>

