<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aufgabengenerator: Scheitelform zur allgemeinen Form</title>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* A simple custom font from Google Fonts for better readability */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="bg-white p-8 rounded-xl shadow-lg max-w-2xl w-full">

        <h1 class="text-2xl font-bold text-gray-800 mb-2">Aufgabengenerator</h1>
        <p class="text-gray-600 mb-6">Übe die Umformung von der Scheitelform zur allgemeinen Form.</p>

        <!-- Task Section -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-md mb-6">
            <h2 class="font-semibold text-gray-700">Gegebene Scheitelform:</h2>
            <p id="scheitelform-anzeige" class="text-xl font-mono tracking-wider mt-2 text-blue-900"></p>
        </div>

        <!-- Input Section -->
        <div class="mb-6">
            <h2 class="font-semibold text-gray-700 mb-3">Deine Lösung für: <span class="font-mono">y = ax² + bx + c</span></h2>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div class="flex items-center space-x-2">
                    <label for="a-input" class="text-lg font-medium text-gray-600">a =</label>
                    <input type="number" id="a-input" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="flex items-center space-x-2">
                    <label for="b-input" class="text-lg font-medium text-gray-600">b =</label>
                    <input type="number" id="b-input" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="flex items-center space-x-2">
                    <label for="c-input" class="text-lg font-medium text-gray-600">c =</label>
                    <input type="number" id="c-input" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>
        
        <!-- Feedback Message -->
        <div id="feedback" class="h-8 mb-4 text-center font-semibold text-lg"></div>

        <!-- Action Buttons -->
        <div class="flex flex-wrap gap-4 justify-center">
            <button onclick="pruefeLoesung()" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">Lösung prüfen</button>
            <button onclick="neueAufgabe()" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700 transition-colors duration-200">Neue Aufgabe</button>
            <button onclick="zeigeLoesung()" class="bg-gray-200 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-300 transition-colors duration-200">Lösung anzeigen</button>
        </div>

        <!-- Solution Path -->
        <div id="loesungsweg" class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200" style="display: none;">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Musterlösung</h3>
            <div id="loesung-text" class="space-y-2 text-gray-700"></div>
        </div>
    </div>

    <script>
        // Holds the correct values for a, b, and c
        let korrekteWerte = { a: 0, b: 0, c: 0 };
        // Holds the parameters of the vertex form
        let scheitelformWerte = { a: 0, xs: 0, ys: 0 };

        // DOM elements
        const scheitelformAnzeige = document.getElementById('scheitelform-anzeige');
        const aInput = document.getElementById('a-input');
        const bInput = document.getElementById('b-input');
        const cInput = document.getElementById('c-input');
        const feedbackEl = document.getElementById('feedback');
        const loesungswegEl = document.getElementById('loesungsweg');
        const loesungTextEl = document.getElementById('loesung-text');

        /**
         * Generates a random integer within a specified range.
         * @param {number} min - The minimum value.
         * @param {number} max - The maximum value.
         * @returns {number} A random integer.
         */
        function generiereZufallszahl(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        /**
         * Creates a new task by generating a new quadratic equation in vertex form.
         */
        function neueAufgabe() {
            // Generate random values for a, xs, and ys
            scheitelformWerte.a = generiereZufallszahl(2, 5) * (Math.random() < 0.5 ? 1 : -1); // a between -5 and 5, excluding -1, 0, 1
            if ([-1, 0, 1].includes(scheitelformWerte.a)) scheitelformWerte.a = 2;
            
            scheitelformWerte.xs = generiereZufallszahl(-5, 5);
            scheitelformWerte.ys = generiereZufallszahl(-10, 10);
            
            // Display the vertex form equation
            let xs_text = scheitelformWerte.xs === 0 ? "" : (scheitelformWerte.xs > 0 ? ` - ${scheitelformWerte.xs}` : ` + ${-scheitelformWerte.xs}`);
            let ys_text = scheitelformWerte.ys === 0 ? "" : (scheitelformWerte.ys > 0 ? ` + ${scheitelformWerte.ys}` : ` - ${-scheitelformWerte.ys}`);
            scheitelformAnzeige.textContent = `y = ${scheitelformWerte.a}(x${xs_text})²${ys_text}`;

            // Calculate the correct values for the general form (ax^2 + bx + c)
            korrekteWerte.a = scheitelformWerte.a;
            korrekteWerte.b = -2 * scheitelformWerte.a * scheitelformWerte.xs;
            korrekteWerte.c = scheitelformWerte.a * scheitelformWerte.xs * scheitelformWerte.xs + scheitelformWerte.ys;

            // Reset input fields and feedback
            aInput.value = '';
            bInput.value = '';
            cInput.value = '';
            feedbackEl.textContent = '';
            loesungswegEl.style.display = 'none';
        }

        /**
         * Checks the user's solution against the correct values.
         */
        function pruefeLoesung() {
            const a_user = parseFloat(aInput.value);
            const b_user = parseFloat(bInput.value);
            const c_user = parseFloat(cInput.value);

            if (a_user === korrekteWerte.a && b_user === korrekteWerte.b && c_user === korrekteWerte.c) {
                feedbackEl.textContent = "Super, alles richtig! ✅";
                feedbackEl.className = "h-8 mb-4 text-center font-semibold text-lg text-green-600";
            } else {
                feedbackEl.textContent = "Leider nicht ganz richtig. Versuche es erneut! ❌";
                feedbackEl.className = "h-8 mb-4 text-center font-semibold text-lg text-red-600";
            }
        }

        /**
         * Displays the step-by-step solution.
         */
        function zeigeLoesung() {
            const { a, xs, ys } = scheitelformWerte;
            const xs_abs = Math.abs(xs);
            const xs_op = xs >= 0 ? '-' : '+';
            const ys_op = ys >= 0 ? '+' : '-';
            const ys_abs = Math.abs(ys);
            
            // Helper function to format numbers with signs
            const formatSign = (num) => num >= 0 ? `+ ${num}` : `- ${Math.abs(num)}`;

            // Build the solution steps as HTML
            const loesungHTML = `
                <p class="font-semibold"><strong>Ausgangsgleichung:</strong> <span class="font-mono">${scheitelformAnzeige.textContent}</span></p>
                <div class="mt-4 border-t pt-4">
                    <p><strong>1. Klammer auflösen:</strong> <span class="font-mono">(x ${xs_op} ${xs_abs})² = x² ${formatSign(-2 * xs)}x ${formatSign(xs * xs)}</span></p>
                    <p class="pl-4 text-sm text-gray-500">Dies geschieht durch Multiplikation: (x ${xs_op} ${xs_abs}) * (x ${xs_op} ${xs_abs})</p>
                </div>
                <div class="mt-4 border-t pt-4">
                    <p><strong>2. Den Faktor ${a} multiplizieren:</strong></p>
                    <p class="pl-4 font-mono">y = ${a} * (x² ${formatSign(-2 * xs)}x ${formatSign(xs * xs)}) ${formatSign(ys)}</p>
                    <p class="pl-4 font-mono">y = ${a}x² ${formatSign(a * -2 * xs)}x ${formatSign(a * xs * xs)} ${formatSign(ys)}</p>
                </div>
                <div class="mt-4 border-t pt-4">
                    <p><strong>3. Konstanten zusammenfassen:</strong></p>
                    <p class="pl-4 font-mono">y = ${korrekteWerte.a}x² ${formatSign(korrekteWerte.b)}x ${formatSign(korrekteWerte.c)}</p>
                </div>
                <div class="mt-6 p-3 bg-blue-100 rounded-md text-center">
                    <p class="font-bold">Ergebnis: a = ${korrekteWerte.a}, b = ${korrekteWerte.b}, c = ${korrekteWerte.c}</p>
                </div>
            `;
            
            loesungTextEl.innerHTML = loesungHTML;
            loesungswegEl.style.display = 'block';
        }

        // Generate the first task when the page loads
        window.onload = neueAufgabe;
    </script>

</body>
</html>
